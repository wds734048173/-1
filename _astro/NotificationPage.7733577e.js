import{h as a,p as g}from"./hooks.module.7cc4e70a.js";import{a as u,b as v}from"./http.82ebf0f1.js";import{p as N}from"./page.c1a8a472.js";import{u as b}from"./use-toast.fb52de5d.js";import{o as e}from"./jsxRuntime.module.afbf92fe.js";import"./preact.module.7b19fc78.js";import"./jwt.f0e0aa9c.js";import"./index.a98c85f5.js";import"./toast.1fe7142d.js";const x="/_astro/close-dark.a501152c.svg",y="/_astro/accept.2820a24f.svg";function M(){const p=b(),[n,i]=a(!1),[r,o]=a([]),[w,c]=a(""),h=async()=>{const{error:t,response:s}=await u("https://api.roadmap.sh/v1-get-invitation-list");if(t||!s){p.error(t?.message||"Something went wrong");return}o(s)};async function l(t,s){i(!0),c("");const{response:d,error:m}=await v(`https://api.roadmap.sh/v1-respond-invite/${s}`,{status:t});if(m||!d){c(m?.message||"Something went wrong"),i(!1);return}t==="accept"?window.location.href=`/team/progress?t=${d.teamId}`:(window.dispatchEvent(new CustomEvent("refresh-notification",{detail:{count:r.length-1}})),o(r.filter(f=>f._id!==s)),i(!1))}return g(()=>{h().finally(()=>{N.set("")})},[]),e("div",{children:[e("div",{class:"mb-8 hidden md:block",children:[e("h2",{className:"text-3xl font-bold sm:text-4xl",children:"Notification"}),e("p",{className:"mt-2 text-gray-400",children:"Manage your notifications"})]}),r.length===0&&e("div",{className:"flex items-center justify-center mt-6",children:e("p",{className:"text-gray-400",children:["No notifications, you can ",e("a",{href:"/team/new",className:"text-blue-500 underline hover:no-underline",children:"create a team"})," and invite your friends to join."]})}),e("div",{className:"space-y-4",children:r.map(t=>e("div",{className:"flex items-center justify-between rounded-md border p-2",children:[e("div",{className:"flex items-center space-x-4",children:e("div",{className:"min-w-0 flex-1",children:e("p",{className:"truncate text-sm font-medium text-gray-900",children:t.name})})}),e("div",{className:"flex items-center space-x-2",children:[e("button",{type:"button",disabled:n,className:"inline-flex border p-1 rounded hover:bg-gray-50 disabled:opacity-75",onClick:()=>l("accept",t?._id),children:e("img",{src:y,className:"h-4 w-4"})}),e("button",{type:"button",disabled:n,className:"inline-flex border p-1 rounded hover:bg-gray-50 disabled:opacity-75",onClick:()=>l("reject",t?._id),children:e("img",{src:x,className:"h-4 w-4"})})]})]}))})]})}export{M as NotificationPage};
